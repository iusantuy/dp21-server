{% load custom_filters %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Invoice {{ invoice_number }}</title>
</head>
<body style="font-family: Arial, sans-serif; background-color: #f9fafb; padding: 40px; position: relative;">

  <!-- Background Watermark -->
  {% for w in watermarks %}
  <span style="
    position:absolute;
    top:{{ w.top }};
    left:{{ w.left }};
    font-size:48px;
    font-weight:bold;
    color:#d1d5db;
    opacity:0.1;
    transform:rotate(-45deg);
    user-select:none;
    pointer-events:none;
    white-space:nowrap;
  ">{{ store_name }}</span>
  {% endfor %}

  <!-- Invoice Container -->
  <div style="position: relative; background: white; padding: 32px; border:1px solid #e5e7eb; border-radius:8px; width:210mm; min-height:297mm; margin:auto; box-shadow:0 0 10px rgba(0,0,0,0.05); z-index:10;">

    <!-- Header -->
    <div style="display:flex; justify-content:space-between; align-items:flex-start; border-bottom:2px solid #e5e7eb; padding-bottom:16px; margin-bottom:24px;">
      <div style="flex:1;">
        <h1 style="font-size:28px; font-weight:bold; margin:0; color:#111827;">INVOICE</h1>
        <p style="margin:4px 0 0; font-size:14px; color:#6b7280;">Snacks and Lunch Boxes</p>
        <p style="margin:8px 0 0; font-size:14px; color:#374151;">
          <strong>Nomor Tagihan:</strong> {{ invoice_number }}<br>
          <strong>Tanggal:</strong> {{ date }}
        </p>
      </div>
      {% if store_logo_url %}
      <div style="flex-shrink:0;">
        <img src="{{ store_logo_url }}" alt="{{ store_name }} logo" style="width:100px; height:100px; object-fit:contain;">
      </div>
      {% endif %}
    </div>

    <!-- Customer Info -->
    <!-- <div style="display:flex; justify-content:space-between; font-size:14px; color:#374151; margin-bottom:24px;">
      <div>
        <p style="margin:0;"><strong>Kepada:</strong> {{ customer_name }}</p>
      </div>
      <div style="text-align:right;">
        <p style="margin:0;"><strong>Kontak:</strong> {{ contact }}</p>
      </div>
    </div> -->

    <div style="display:flex; justify-content:space-between; font-size:14px; color:#374151; margin-bottom:24px;">
      <div>
        <strong>Kepada:</strong>
        <p>{{ customer_name }}</p>
      </div>
      <div style="text-align:right;">
        <strong>Kontak:</strong>
        <p>{{ contact }}</p>
      </div>
    </div>

    <!-- Customer Info -->
    <!-- <div style="
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
      font-size: 14px;
      color: #374151;
      gap: 20px;
      flex-wrap: wrap; /* biar responsif */
    ">
      <div style="
        flex: 1;
        min-width: 45%;
        word-wrap: break-word;
        white-space: pre-wrap;
      ">
        <p style="margin:0; font-weight:bold;">Kepada:</p>
        <p style="margin:2px 0;">{{ customer_name }}</p>
        {% if customer_address %}
        <p style="margin:2px 0;">{{ customer_address }}</p>
        {% endif %}
      </div>

      <div style="
        flex: 1;
        min-width: 45%;
        text-align: right;
        word-wrap: break-word;
        white-space: pre-wrap;
      ">
        <p style="margin:0; font-weight:bold;">Kontak:</p>
        <p style="margin:2px 0;">{{ contact }}</p>
      </div>
    </div> -->

    <!-- Items Table -->
    <table style="width:100%; border-collapse:collapse; font-size:14px; margin-bottom:16px;">
      <thead>
        <tr style="background-color:#f3f4f6; border-bottom:1px solid #e5e7eb;">
          <th style="text-align:left; padding:8px;">Menu</th>
          <th style="text-align:center; padding:8px;">Qty</th>
          <th style="text-align:right; padding:8px;">Harga</th>
          <th style="text-align:right; padding:8px;">Total</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
        <tr style="border-bottom:1px solid #e5e7eb; background-color:{% cycle '#ffffff' '#f9fafb' %};">
          <td style="padding:8px; color:#374151;">{{ item.menu }}</td>
          <td style="padding:8px; text-align:center; color:#374151;">{{ item.quantity }}</td>
          <td style="padding:8px; text-align:right; color:#374151;">Rp {{ item.price|rupiah}}</td>
          <td style="padding:8px; text-align:right; color:#374151;">Rp {{ item.quantity|mul:item.price|rupiah}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Totals Section -->
    <div style="text-align:right; font-size:14px; color:#111827; margin-bottom:24px;">
      <p style="margin:4px 0;"><strong>Total Harga Item:</strong> Rp {{ subtotal|rupiah}}</p>
      <p style="margin:4px 0;"><strong>DP:</strong> Rp {{ dp|rupiah}}</p>
      <p style="margin:4px 0; font-size:16px; font-weight:bold;"><strong>Total Bayar:</strong> Rp {{ total|rupiah }}</p>
    </div>

    <!-- Payment Info -->
    <div style="border-top:1px solid #e5e7eb; padding-top:12px; font-size:14px; color:#374151; margin-bottom:40px;">
      <p style="margin:0;"><strong>Pembayaran:</strong> {{ payment_method }}</p>
      <p style="margin:0;"><strong>Ket:</strong> {{ ket }}</p>
    </div>

    <!-- Signatures -->
    <div style="   
      text-align:center;
      display:flex;
      justify-content:space-between;
      margin-top:40px;
    ">
      <div style="width:45%;">
        <p style="margin-bottom:80px;">Tanda Terima</p>
        <p style="margin:0; border-top:1px solid #000; display:inline-block; width:80%;"></p>
      </div>
      <div style="width:45%;">
        <p style="margin-bottom:80px;">Hormat Kami</p>
        <p style="margin:0; border-top:1px solid #000; display:inline-block; width:80%;"></p>
      </div>
    </div>

    <!-- Footer -->
    <footer
      style="
        position: absolute;
        bottom: 10mm;
        left: 0;
        width: 100%;
        text-align: center;
        font-size: 12px;
        color: #9ca3af;
        padding: 0;
      ">
      <!-- Garis -->
      <div style="position: relative; width: 100%; border-top: 1px solid #e5e7eb; height: 20px;">
        <!-- Konten di tengah garis -->
        <div style="
          position: absolute;
          top: -10px; /* naik setengah tinggi garis */
          left: 50%;
          transform: translateX(-50%);
          background: white; /* biar garis di belakang teks dan icon */
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 0 4px;
        ">
          <!-- <img src='/static/icons/instagram.svg' alt='Instagram' style='width:14px;height:14px;'> -->
          <img src="{{ store_logo_url }}" alt='Instagram' style='width:14px;height:14px;'>
          <span>@dolcepapa.21</span>
        </div>
      </div>

      <!-- Slogan -->
      <p style="margin:4px 0 0 0; font-style:italic; color:#6b7280;">
        Life's Sweeter with Papaâ€™s Sugar 
      </p>
    </footer>
  </div>
</body>
</html>

